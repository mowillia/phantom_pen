Nearly 30 years ago, when just 15 percent of Americans had a computer, and even fewer had internet access, Thomas Parkinson set up a rack of modems on a Crate and Barrel wine rack and started accepting orders for the internet’s first grocery-delivery company, Peapod, which he founded with his brother Andrew.

Back then, ordering groceries online was complicated—most customers had dial-up, and Peapod’s web graphics were so rudimentary that customers couldn’t see images of what they were buying. Delivery was complicated, too: The Parkinsons drove to grocery stores in the Chicago area, bought what customers had ordered, and then delivered the goods from the backseat of their beat-up Honda Civic. When people wanted to stock up on certain goods—strawberry yogurt or bottles of Diet Coke—the Parkinsons would deplete whole sections of local grocery stores.

Peapod is still around today. But convincing customers to order groceries online is still nearly as difficult now as it was in 1989. Twenty-two percent of apparel sales and 30 percent of computer and electronics sales happen online today, but the same can be said for only 3 percent of grocery sales, according to a report from Deutsche Bank Securities. “My dream was for it to be ubiquitous, but getting that first order can be a bit of a hurdle,” Parkinson told me from Peapod’s headquarters in downtown Chicago. (He is now Peapod’s chief technology officer; his brother has since left the company.)

Until online grocery-delivery companies are delivering to hundreds of homes in the same neighborhood, it will be very hard for them to make a profit. Though it is an $800 billion business, grocery is famously low-margin; most grocery stores are barely profitable as it is. Add on the labor, equipment, and gas costs of bringing food to people’s doors quickly and cheaply, and you have a business that seems all but guaranteed to fail. “No one has made any great amount of money selling groceries online,” Sucharita Kodali, an analyst with Forrester Research, told me. “In fact, there have been a lot more people losing money.”

This is not true in every country. In South Korea, 20 percent of consumers buy groceries online, and both in the United Kingdom and Japan, 7.5 percent of consumers do, according to Kantar Consulting. But those are countries with just a few large population centers, which makes it easier for delivery companies to set up shop in a few big cities and access a huge amount of purchasing power. In the United States, by contrast, people are spread out around rural, urban, and suburban areas, making it hard to reach a majority of shoppers from just a few physical locations. In South Korea and Japan, customers are also more comfortable with shopping on their phone than consumers are in countries like the United States.

But companies are still trying to make online grocery delivery work in the United States. Today, Peapod is one of dozens of companies offering grocery delivery to customers in certain metro areas. In June 2017, Amazon bought Whole Foods for $13.4 billion and started rolling out grocery delivery for Prime members in cities across the country; analysts predicted at the time that the company’s logistics know-how would allow it to leverage Whole Foods stores to dominate grocery delivery. Also in 2017, Walmart acquired Parcel, a same-day, last-mile delivery company. Two months after that, Target said it was buying Shipt, a same-day delivery service. Kroger announced last May that it was partnering with Ocado, a British online grocer, to speed up delivery with robotically operated warehouses. Companies like ALDI, Food Lion, and Publix have started working with Instacart to deliver groceries from their stores. FreshDirect recently opened a highly automated 400,000-square-foot delivery center and says it plans to expand to regions beyond New York, New Jersey, and Washington, D.C., in the coming year.

The story of Peapod, which has had 30 years to perfect the art of online grocery delivery, suggests that making money will be a challenge for even deep-pocketed retailers like Amazon. Peapod has more experience than any other online grocery-delivery company. It outlasted Webvan, which raised $800 million before crashing in 2001, and beat out other big bets of the dot-com boom such as Kozmo, Home Grocer, and ShopLink.

Peapod itself nearly failed in 2000 before being rescued by the Dutch conglomerate Royal Ahold NV, which bought first a controlling interest and then the entire company. (After a recent merger, Peapod’s parent company is now called Ahold Delhaize—it owns supermarket chains like Food Lion, Hannaford, and Stop & Shop.) In 2016, Peapod was only in the black in three markets, a Peapod executive told The Wall Street Journal that year. The company has not been able to get enough people to buy groceries online to lower the costs of delivering them. If a company with 30 years of experience in grocery delivery can’t make it work, can anyone?

Compared to groceries, clothes and electronics and dog food are incredibly simple to deliver. A company like Amazon keeps those products stored in a warehouse, packs them in a box, and sends them on their way through the mail or through its delivery contractors.

Groceries, though, can’t just be packed in a box and entrusted to mail carriers. Imagine fulfilling an order that includes popsicles, avocados, a case of Coke, and tortilla chips. The popsicles have to be kept cold, the avocados have to be chosen carefully, the Coke is heavy, and the tortilla chips can’t be crushed. Now consider that the average Peapod order has 52 items.

Because of these factors, it will always be cheaper for grocery stores to have customers come to them, and do all the work of shopping themselves, than it will be for the stores to bring the groceries to the customers, said Kodali, the Forrester analyst. “In the best case, you only make the same as what you would make in stores,” Kodali said. “It’s not like it’s a more profitable distribution channel.” One of Amazon’s big innovations in delivering packages was that it could cut out the middleman (the store) and sell things directly to consumers, saving the cost of overhead. But consumer packaged-goods companies can’t cut out the stores, since they don’t have the infrastructure in place to get their products, whether it be ice cream or avocados, directly to consumers.

Peapod has tried to lower its overhead in a few ways. In some markets, it keeps groceries in vast warehouses outside of town, which saves money because the company doesn’t have to buy or rent retail space in city centers. Peapod has figured out how to make the shopping part of online grocery delivery relatively fast, which means one employee can process dozens of orders in just a few hours. In “warerooms,” which are essentially smaller stores on top of grocery stores, aisles are much narrower than they are in regular grocery stores. Employees wear devices on their wrists that tell them on what aisle and shelf a product is located, and they load food into baskets efficiently, scanning bar codes. Workers get intimately familiar with where various items are located, allowing them to shop quickly.

Despite Peapod’s innovations, the whole process is very labor-intensive. Peapod’s workers still have to scan the groceries packed into orders with a temperature gun to make sure meat hasn’t gotten too warm; they also have to audit the totes to make sure that items aren’t broken and that nothing is missing. (Ahold, Peapod’s parent company, is already using robots to speed some parts of packing customers’ orders.)

Delivery can be slow-going, too. I tagged along with one Peapod driver, Ricardo Bernard, on a Friday afternoon as he brought groceries to consumers’ doorsteps in a wealthy neighborhood of Chicago. We were assigned 19 stops in Chicago’s South Loop, which was heavily congested and included a number of apartment buildings; Bernard kept having to park the truck in narrow spots, get out, unload the totes of groceries onto a dolly, call the tenant from an intercom (or get let in by a doorman), wait for an elevator, ride the elevator, and then wait for tenants to open their door so he could unpack the totes onto their kitchen counter, a process than can take more than 10 minutes for each delivery.

The most efficient grocery-delivery companies are really logistics companies. Employees at Peapod’s headquarters tinker with routes and monitor weather and traffic in real time so they can make changes if a storm is coming or a concert is causing congestion, all to shave seconds or minutes off delivery routes. The company times how long drivers are sitting in traffic; how long they go between deliveries; how much time they spend with customers. It rewards drivers who get deliveries completed faster than average but who maintain high scores from customers.

Grocery companies may have to spend more money opening more brick-and-mortar stores to make logistics easier and to lessen the amount of time delivery drivers have to be on the road. A D.A. Davidson analyst, Tom Forte, recently wrote that he thought Amazon should acquire thousands of gas stations to “advance its delivery efforts.” (Amazon declined to comment on the specifics of its grocery-delivery business, but said that it has expanded to deliver groceries in 60 metros since it bought Whole Foods last February.)

Even though it’s spent years shaving seconds off deliveries, Peapod struggles to make the financials work. The company charges a delivery fee that ranges from $6.95 to $9.95 per order. That might seem steep to people accustomed to getting everything delivered for free, but it does not come close to covering the costs associated with bringing groceries to customers’ doors. “Getting costs down is a work in progress,” Ken Fanaro, Peapod’s senior director of transportation planning and development, told me. Online grocery delivery is really only cost-efficient when companies can spend the bulk of their time bringing groceries into homes from trucks, rather than driving miles and then bringing groceries into homes. “In a perfect world, we’d be like a mailman, going down the street, delivering at every home,” he told me.

Peapod pays handsomely for workers’ time. Bernard, like all Peapod workers, is a full-time employee, who receives health care and other benefits; the company has thus far eschewed the contractor model employed by delivery services like Instacart and Uber Eats.

Today, the markets where Peapod is profitable are the densest ones, like New York City. Even Amazon struggles in suburban markets, announcing last year that it was suspending its Amazon Fresh delivery service in regions of New Jersey, Pennsylvania, and Maryland, while maintaining service in cities like New York, Chicago, and Boston.

Grocery stores are stuck in a tough place right now. They’re facing challenges from big retailers like Walmart and Target, which have started offering produce and fresh food, and from discount chains like Aldi and Lidl, which recently started adding stores in the United States. Now, as Amazon enters more markets, it’s forcing grocery stores to offer delivery, too, even though they’ll lose money on it. If they don’t, customers may go somewhere else. Amazon is using its deep pockets to undercut its competitors on price, taking a page from other tech start-ups like Uber that tried to corner the market first and then make money after.

Some supermarkets have experimented with offering ways that are not as expensive as grocery delivery to make shopping easier for consumers. Walmart, Kroger, Safeway, and a number of other stores offer “click and collect,” for example, which allows consumers to order their groceries online and then drive to the store and pick them up. Click-and-collect represents nearly half of online grocery sales, according to Nielsen data, up from 18 percent in 2016. Amazon is covering both of these bases: In addition to its delivery options, the company has launched Go stores in Seattle, Chicago, and San Francisco that allow customers to walk in, select items, and walk out without waiting in line to pay.

But ubiquity remains the holy grail of grocery delivery, and all the stores know it. So they’re offering discounts and deals to get customers to sign up for delivery services, making thin margins even thinner. Most online grocery-delivery services offer free delivery on a customer’s first order, for example. According to Elley Symmes, a senior analyst on Kantar Consulting’s grocery team, the No. 1 reason many customers got groceries delivered was that they received an incentive to do so. But when those promotions go away, so do the customers. “Delivery costs continue to be a barrier to entry,” Symmes told me.

To be able to offer those incentives without going bankrupt, some supermarkets are partnering with brands to get the cost of delivery subsidized. Colgate may offer free delivery if a customer buys a certain number of Colgate products, for instance.

Cost might not be the only reason customers aren’t flocking to grocery delivery. I asked a few shoppers in a Massachusetts Stop & Shop why they weren’t getting their groceries delivered; they were pushing carts through aisles as Peapod workers packed crates upstairs for delivery. Most said they liked picking out their own meat and produce, and that they don’t like planning their shopping ahead of time. Mike Kolodziej, 37, told me he actually likes going to the grocery store. “It’s my quiet time,” he said. He has five kids at home.

And besides, unlike being a customer in other industries tech has disrupted—going to the post office, taking cabs in certain cities—going grocery shopping isn’t all that unpleasant. In the suburbs, people get in their car and drive to spacious stores where they can pick out the produce they like and also find out about new products on the shelves, says David J. Livingston, a supermarket analyst for DJL Research. Some stores offer other services, like prescription pickup or wine bars, that make them an experience people enjoy—they’re faced with the daunting task of making stores more appealing to people while also making delivery appealing too.

Still, analysts say that now is the time to convert more customers to online grocery delivery. About 41 percent of consumers neither like nor dislike shopping for products like beverages and perishable goods in grocery stores, according to a Deloitte survey. Deloitte argues that there are many consumers “who are not emotionally attached to the physical shopping process and might consider online-shopping options if they were offered.” They include Jim Winnfield, who recently got his first online grocery-delivery order; he used to live in the Chicago suburbs, but recently moved downtown, and decided to give Peapod a try. “I’m lazy enough that I want people to do as much for me as possible,” he told me. Winnfield’s first delivery was free.

However they get customers to sign up, supermarkets are likely going to have to spend a lot of money in promotions and deals as they try to make delivery more popular among consumers. This, of course, advantages Amazon, which has deep pockets and has long been able to convince shareholders that spending up front on getting customers in the door has long-term dividends. This has never been Peapod’s strategy—it outlasted competitors like Webvan because it never spent a lot of money it didn’t have, Parkinson told me.

But even Peapod is now getting into the battle for customer share. In January 2019 alone, Ahold Delhaize said it was launching self-driving grocery-delivery vehicles in Boston and acquired a Long Island chain of supermarkets, expanding the company’s reach. Peapod is currently offering $20 off groceries and no delivery fees for the first 60 days a customer uses the service. It outlasted its competitors over the past few decades by being careful with money, Parkinson told me. Today, though, even Peapod is coming around to the fact that customers are cheap, and whichever company makes its services the cheapest just might win.