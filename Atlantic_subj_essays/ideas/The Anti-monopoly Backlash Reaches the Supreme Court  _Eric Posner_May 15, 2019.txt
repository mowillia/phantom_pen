On Monday, the Supreme Court stymied an effort by Apple to protect its monopoly over sales of iPhone apps. Justice Brett Kavanaugh’s decision in Apple v. Pepper turned on an arcane bit of antitrust law, and it provided the first small hope that the antitrust establishment may finally turn against Big Tech. But the odds remain formidable.

The story begins during an almost unimaginably remote time in the American past—when the internet had not yet been invented, and antitrust law was still taken seriously. It was 1968, and the Supreme Court faced a dispute between Hanover Shoe, a manufacturer, and the United Shoe Machinery Corporation, from which it had leased equipment. Hanover Shoe sought damages on the grounds that United Shoe had used its monopolistic power to overcharge for the machinery.

United Shoe argued that Hanover Shoe had not been injured, because it had been able to pass on the overcharge to its own customers in the form of higher shoe prices. Those customers—that is, ordinary people who buy shoes—possessed the claim against the monopolist, not the intermediary who merely passed on the monopoly price. The Court would have none of it. The ultimate buyers—who might have spent a few extra dollars for their shoes—would not be able to afford a lawsuit. The “direct purchaser” from the manufacturer can bring an antitrust claim even if it does not suffer any damages, the Court ruled. Otherwise, monopolists would be protected from lawsuits.

However, just nine years later, the Supreme Court converted this pro-antitrust holding into an anti-antitrust rule. Illinois Brick Co. v. Illinois involved similar facts. Several manufacturers who allegedly fixed prices sold their goods to an intermediary, who sold them to customers. In Hanover Shoe, the intermediary sued the manufacturer. In Illinois Brick, the customer sued the manufacturers, skipping the intermediary. The customer argued that because the monopoly overcharge was passed on to purchasers, it was entitled to damages.

But this time, the Court ruled for the monopolists. It explained that since Hanover Shoe assigned the antitrust claim to the direct purchaser from the monopolist, there was nothing left to give the customers of the purchaser. If the customers were allowed to sue, liability might be duplicated. The Court dismissed the obvious counterargument—that damages should be shared between the customers and the intermediary according to the extent of harm. Economic theory tells us that the overcharge may sometimes be absorbed by the intermediary, sometimes passed on to customers, and sometimes shared, but that’s hard to define in practice.

Commentators pointed out that this holding made little sense. Usually the customers, not the intermediary, absorb the monopoly overcharge. The new doctrine gave the remedy to the parties least likely to be harmed and withheld it from those most likely to be harmed. And the Court turned out to have been wrong in Hanover Shoe about incentives to sue. Lawyers can organize customers to bring class-action lawsuits. Intermediaries, on the other hand, are usually terrified of monopolist suppliers, and if not, the monopolists can bribe them not to sue by giving them a share of the monopoly profits extracted from consumers.

But the Supreme Court had moved to the right by 1977, and its rightward trend would continue for years to come. The Illinois Brick rule appealed both to the neoliberalism of the time, which disapproved of antitrust liability, and to the fetish for bright-line rules found among many conservative jurists. Bright-line rules, they argued, make law more predictable by limiting the discretion of government officials, including judges—and diminishing the impact of their liberal biases.

It took the tech revolution to make the flaw in this thinking so obvious, the Court could no longer ignore it.

Apple argued that its App Store customers could not sue it because of Illinois Brick. How could this be? The customers handed over money to Apple in return for access to its apps; this seemed like the direct customer relationship that Illinois Brick had blessed. But Apple argued that Apple’s real customers were the developers, who bought from Apple access to the App Store platform by paying a 30 percent commission based on the price of the app. The customers bought their apps from the developers, not from Apple. Since they were not “direct purchasers” from Apple, they could not sue Apple—only the developers could. (Of course, the developers—whose businesses are dependent on the access to consumers that the App Store provides—had not sued Apple, and have so far shown no inclination to do so.)

The argument was not crazy; a similar argument was accepted by a court of appeals 20 years ago. The problem here, as I argued along with other antitrust scholars in an amicus brief filed in the case, was the operation of the Illinois Brick rule, a rule already poorly suited to the brick-and-mortar world that works even less well in the virtual world. A tech giant such as Apple can easily structure its distribution chain however it wants to—just by changing some lines of code and some contractual language—to evade whatever bright-line antitrust rules the Supreme Court throws at it. It shouldn’t matter to Apple whether it makes money off developers (by charging them high commissions, which they might pass on to customers) or customers (by charging them high prices, which the developers might have to offset by lowering their own prices). The labels change; the profits are the same.

Apple’s App Store—unlike a factory, warehouse, or physical store—is just code that sits on servers. Apple’s relationships with its customers and suppliers are also the product of code. This gives Apple degrees of freedom to structure its distribution chain in ways that monopolists of old never enjoyed.

While the Court made some progress in allowing victims of monopolies to obtain a remedy, the government’s decades of neglecting the antitrust violations of Big Tech leave the United States facing an enormous challenge. Indeed, not long ago many cheered tech companies for offering services for free or low prices, without realizing the strategy made sense only if the tech companies recouped their losses by obtaining monopolies.

Regulators then missed the risks of allowing tech firms to consolidate by buying their rivals. And regulators missed the novel ways in which tech companies exploited their monopoly power once they achieved it—by abusing data privacy, eroding service quality, and harassing people with ads they dislike, rather than (like old-time monopolists) simply raising prices.

And, of course, Big Tech, like the old-fashioned monopolists, has bought itself political goodwill. But the tech companies now seem to have overplayed their hand. With scandals mounting, and growing uneasiness about Facebook’s and Google’s influence on political speech—also a result of their monopoly power—a long-overdue anti-monopoly backlash has begun. If the Supreme Court seems unlikely to lead it, then the Court may, at least, not perform its usual function of standing in the way.