A pivotal moment in the trial of Joaquín “El Chapo” Guzmán, the two-time prison escapee and alleged kingpin of Mexico’s infamous Sinaloa cartel, came when prosecutors played for the jury a phone call between Guzmán and a cartel operative nicknamed Gato. Guzmán, federal prosecutors allege, is overheard in the call directing a cartel member to bribe a commander in the Mexican Federal Police.

“Is he receiving the monthly payment?” Guzmán asks.  Gato confirms the cartel is sending the officer regular bribes, then hands the phone over to the “federale” himself, who confirms the payment and pledges his loyalty.  

Guzmán is facing charges of money laundering, drug trafficking, kidnapping, and murder stemming from his time allegedly running an empire that funneled drugs and guns throughout South America and between the U.S. and Mexico. In court, federal prosecutors have played multiple calls from Guzmán: asking for updates, ordering and moving shipments, haggling over the price of kilos, and praising or reprimanding his operatives as they carry out his commands. (“Take it easy with the police,” he scolds Iván “El Cholo” Cruz, the cartel’s top assassin, in one recorded call. “Well, you taught us to be a wolf,” Cruz replies.)

In total, the FBI intercepted more than 200 calls from Guzmán himself, and hundreds more from his operatives, lieutenants, and family members. But only last week did the FBI reveal how: They had an inside man. In court last Thursday, the FBI agent Stephen Marston revealed a series of high-risk operations coordinated with the Sinaloa IT guy, and eventual federal informant, Christian Rodriguez, who has since relocated to the U.S. under FBI protection.

“We realized without insider access to the system we were not going to get inside,” Marston told the court Thursday.

Rodriguez’s first act as informant was to circumvent the secure network he’d installed in Guzmán’s mountain hideout. In May 2010, Rodriguez faked an outage that temporarily took the network offline. Jorge Cifuentes, Rodriguez’s then-boss, assumed the servers were down because Rodriguez had simply forgotten to renew the lease. In truth, the outage was orchestrated to force Guzmán and his agents to use compromised cellphones, which allowed the FBI to listen in on Guzmán allegedly negotiating a six-ton cocaine deal with members of the FARC guerrilla group.

But the outage was only temporary, and Marston and the FBI wanted full access to Guzmán’s network. So agents directed Rodriguez to move the servers for its network from Canada, where encryption laws had circumvented the FBI’s search warrants, to the Netherlands. The Dutch outlet NL Times reported that the Dutch High Tech Crime team worked with the FBI over 18 months to compromise the network and gain access to the hundreds of calls forming the bedrock of the prosecution’s case.

But ultimately, it was Guzmán’s own fondness for surveillance that helped federal agents charge him. Rodriguez testified in court that, at Guzmán’s behest, he personally installed 50 BlackBerry phones with monitoring software called “FlexiSpy.” The software is undetectable and can read text messages and call logs, steal passwords saved to the device, and remotely switch on and listen to the microphone. It markets itself as a form of parental control and employee monitoring, and starts at $68 a month. (The software has drawn harsh condemnation from technologists and advocacy groups supporting domestic violence survivors, who say the software abets stalking and empowers abusers to control their victims.)

Guzmán called the BlackBerrys his “special phones” and used them to spy on his inner circle—eventually developing a habit, Rodriguez told the court, of making unexpected phone calls to his people, then activating the microphone after the call ended to hear what they said about him. Rodriguez sent the phone not only to his lieutenants, but to his wife, children, and mistresses as well. “How are the sales going?” he texts a mistress, Agustina Cabanillas Acosta, in 2012. “Like busy bees,” she replies.

Rodriguez told the FBI of El Chapo’s internal spy network and agents subpoenaed FlexiSpy, obtaining the messages between Guzmán and his wife and girlfriends, who worked as operatives themselves. Both Acosta and Guzmán’s wife, Emma Coronel Aispuro, suspected Guzmán of using their BlackBerrys to spy on them—even as no one in the cartel seemed to have any suspicions about Rodriguez. Acosta reportedly texted a friend she “[didn’t] trust” the BlackBerrys  “because the bastard can locate them.”

“I’m way smarter than him,” she added.